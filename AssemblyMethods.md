# Transcriptome Assembly

## Sai Manoj Tekumalla

# Methods:

## Use of Trinity:
There are two means usually used to covert the raw RNA-Seq data extracted in the previous module to transcript
sequences. They include de novo assembly and reference-guided assembly. The latter one is most commonly used 
approach. One tool which can be used to assemble the reads or to form a transcript is the trinity tool which 
is effective to assemble the transcript in both the approaches. Trinity uses parallel computing to reconstruct
transcripts based on the individual de Bruijn graphs generated for every expressed gene[1].

### Mechanism of trinity tool:
This tool uses 3 modules to construct a transcript, they include;
#### 1. Inchworm:
All the overlapping k-mers are extracted from the Paired and Unpaired reads generated in the 
previous module. Trinity using inchworm module will produce unique portions of alternatively spliced transcrip-
-ts (transcript contigs) since the data set here is not very repetitive.  
#### 2. Chrysalis: 
This will cluster all the related transcript contigs generated by inchworm, builds de Bruijn
graph for every cluster. 
#### 3. Butterfly: 
This will analyze each RNA-Seq read through the graph and determines connectivity. If no co-
-nnection is found, this module will split the graph into many sub-graphs and will analyze every graph and rep-
-orts a full-length transcript. 

## Reference-guided assembly:

### Merge bam files: 
This is performed using the program mergeAll.sh, which will merge all the bam files previ-
-ously generated into a single bam file. This is done since trinity would only take one file as the input. This
was performed using samtools merge function. The merged bam file is names AipAll.bam. 

### Assemble the transcriptome: 
This is performed using the program runTrinity.sh. Here, trinity tool is made 
use of to create a transcriptome based on the genome guided assembly approach. A path to the trinity assembler
is specified in the program, also, it is specified that the trinity has to assemble the transcipt based on the 
genome-guided assembly of the merged bam file. This program will give out the output in the form of a fasta fi-
-le which contains the assembled transcripts/transcriptome. To check the statistics of the transcriptome, anoth-
-er program names, analyzeTrinity.sh is written which basically takes in the assembled transcriptome file (fas-
-ta format) and will give out data like the total number of genes, transcripts, GC percentage, contig specific 
statistics as well, including N10, N50 data as well. 

#### N50: 
This is just a length of a specific contig in all the assembled transcripts. For instance, if there a-
-re 4 trancripts whose lengths are 200, 200, 100, 500 and the total of lengths of all trancripts is 1000. N50 is
the length of the contig that covers half the length of the transcripts together. In this case N50 number is 100
since it covers half the total number of length of the transcripts above and below it[3]. 

## De-novo assembly: 
Again, trinity tool is made use of here to create a transcriptome, but based on the de-novo
assembly approach. Trinity tool in this approach specifically would only take in fastq files for the left and ri-
-ght reads in list format which are separated by commas. To do this, trinityDeNovo1.sh program is performed. And
for the assembly, another program trinityDeNovo.sh is run. Here, trinity de-novo assembly command is specified to
follow de-novo approach. Here, all the modules, like, inchworm, chrysalis basically perform the action, third-par-
-ty tool like jellyfish is also used to build the initial k-mer catalog. This program would also give the output 
in the form of a fasta file which contains the assembled transcripts/transcriptome. To check the statistics of t-
-he transcriptome, another program names, analyzeTrinityDeNovo.sh is written which basically takes in the assemb-
-led transcriptome file (fasta format) and will give out data like the total number of genes, transcripts, GC pe-
-rcentage, contig specific statistics as well, including N10, N50 data as well. 
The N50 in both runs changed very little since the number of the transcripts generated in both the trinity run pr-
-ograms, the genome-guided assembly and de-novo assembly, is almost similar[2]. 27.5k trancripts generated in gen-
-ome-guided assembly approach, while de-novo generated 30k trancripts. This resulted in the slight difference in 
N50 numbers as also, the average contig lengths in both the approaches has a very little difference. 

# Citations:
[1] De novo transcript sequence reconstruction from RNA-seq using the Trinity platform for reference generation a-
-nd analysis

Haas et al.

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3875132/

[2] Assembly of large genomes using second-generation sequencing

Schatz et al.

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2928494/

[3] Whats N50?

https://www.molecularecologist.com/2017/03/29/whats-n50/

 
